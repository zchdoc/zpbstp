<!DOCTYPE html>
<html lang="zh">
<meta charset="UTF-8">
<head>
  <title>è·å–IPåœ°å€</title>
</head>
<body>
<h1>IPåœ°å€æŸ¥è¯¢ç»“æœ</h1>
<div id="allIpAddressContainer"></div>
<hr>
<h2>å»é‡åçš„IPåœ°å€</h2>
<div id="uniqueIpAddressContainer"></div>
<script>
  function getLocalIp() {
    console.info("æœ¬åœ°IPæš‚æ— åŠæ³•ğŸ¤”");
  }

  // åˆ›å»ºå¹¶å‘é€è¯·æ±‚
  function getPublicIp(url) {
    let result = '';
    const request = new XMLHttpRequest()
    request.open('GET', url, true);
    request.onload = function () {
      if (request.status >= 200 && request.status < 400) {
        // è¯·æ±‚æˆåŠŸ,è·å–IPåœ°å€å¹¶æ˜¾ç¤º
        const ipAddress = request.responseText.trim()
        const allIpAddressContainer = document.getElementById('allIpAddressContainer')
        const uniqueIpAddressContainer = document.getElementById('uniqueIpAddressContainer')
        // æ˜¾ç¤ºæ‰€æœ‰ç»“æœ
        const allIpAddressElement = document.createElement('p')
        allIpAddressElement.textContent = ipAddress;
        allIpAddressContainer.appendChild(allIpAddressElement);
        result = url+" "+ipAddress;
        // æ£€æŸ¥å¹¶æ˜¾ç¤ºå»é‡åçš„ç»“æœ
        if (!ipSet.has(ipAddress)) {
          ipSet.add(ipAddress);
          const uniqueIpAddressElement = document.createElement('p')
          uniqueIpAddressElement.textContent = ipAddress;
          uniqueIpAddressContainer.appendChild(uniqueIpAddressElement);
        }
      }
      else {
        // è¯·æ±‚å¤±è´¥
        console.error('Error fetching IP address:', request.statusText);
        result = url+" "+request.statusText;
      }
    };
    request.onerror = function () {
      // è¯·æ±‚é”™è¯¯
      console.error('Request failed');
    };
    request.send();
    console.info(result);
  }

  getLocalIp();
  
  /**
   * http://1111.ip138.com/ic.asp
   * http://ip.360.cn/IPShare/info
   * http://www.ip508.com/ip
   * http://myip.com.tw/
   * http://ip.xianhua.com.cn/
   * http://www.ip.cn/
   * http://www.123cha.com/ip
   * http://www.ip38.com/
   * http://ip.chinaz.com
   * http://www.cz88.net/ip/index.aspx
   * http://www.taobao.com/help/getip.php
   */
  const urls = [
    'https://checkip.amazonaws.com',
    'https://api.ipify.org',
    'https://ifconfig.me/ip',
    'https://icanhazip.com',
    'https://ipinfo.io/ip',
    'https://ipecho.net/plain',
    'https://checkipv4.dedyn.io'
  ]
  // å­˜å‚¨IPåœ°å€çš„é›†åˆ
  const ipSet = new Set()
  // éå†ç½‘å€åˆ—è¡¨,å‘é€è¯·æ±‚è·å–IPåœ°å€
  urls.forEach(function (url) {
    getPublicIp(url);
  });
</script>
</body>
</html>
